(self.modernJsonp=self.modernJsonp||[]).push([["78946"],{316387:function(e,t,i){var n,a;i.r(t),i.d(t,{default:()=>o});let l=(a=[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CommentThreadContainer_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"commentCount",storageKey:null},{alias:null,args:null,concreteType:"AggregatedDidItData",kind:"LinkedField",name:"didItData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imagesCount",storageKey:null}],storageKey:null},n],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"doneByMe",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commentsDisabled",storageKey:null},n,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});l.hash="6e4bec581cece19361386d6124ddde90";let o=l},658559:function(e,t,i){var n,a,l,o;i.r(t),i.d(t,{default:()=>r});let s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DescriptionWithLinksAndMentions_pin",selections:[{alias:null,args:null,concreteType:"TextTag",kind:"LinkedField",name:"descriptionLinks",plural:!0,selections:[n={alias:null,args:null,kind:"ScalarField",name:"length",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"objectId",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"offset",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"tagType",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextTag",kind:"LinkedField",name:"userMentionTags",plural:!0,selections:[n,a,l,o],storageKey:null}],type:"Pin",abstractKey:null};s.hash="77396be9e54491e35d44dc059d7664fc";let r=s},441590:function(e,t,i){var n,a,l,o,s;i.r(t),i.d(t,{default:()=>d});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualContext_pin",selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"duration",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captionsUrls",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:o,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtype",storageKey:null}],storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s=[l,n,a],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"236x")'},{alias:"imageSpec_1200x",args:[{kind:"Literal",name:"spec",value:"1200x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"1200x")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isVideo",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetMainPinImage_pin"}],type:"Pin",abstractKey:null};r.hash="f5ddfd6a30ebe10b0f0a7b0bf12bea4e";let d=r},673588:function(e,t,i){var n;i.r(t),i.d(t,{default:()=>l});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGetMainPinImage_pin",selections:[{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"236x")'},{alias:"imageSpec_1200x",args:[{kind:"Literal",name:"spec",value:"1200x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"1200x")'}],type:"Pin",abstractKey:null};a.hash="64a50a10a8f854ca82309453d98f41a7";let l=a},767439:function(e,t,i){i.d(t,{Z:()=>l});var n=i(667294);let a="undefined"!=typeof document?document:{},l=()=>{let e=(0,n.useRef)(void 0),t=a.documentElement,{body:i}=a;return t?[()=>{if(!i||!i.style||e.current)return;let n=window.innerWidth-t.clientWidth,a=parseInt(window.getComputedStyle(i).getPropertyValue("padding-right"),10)||0;t.style.position="relative",t.style.overflow="hidden",i.style.position="relative",i.style.overflow="hidden",i.style.paddingRight=`${a+n}px`,e.current=!0},()=>{i&&i.style&&e.current&&(t.style.position="",t.style.overflow="",i.style.position="",i.style.overflow="",i.style.paddingRight="",e.current=!1)}]:[]}},762802:function(e,t,i){i.d(t,{Z:()=>s});var n=i(667294),a=i(765533),l=i(603316);class o extends n.PureComponent{constructor(...e){var t,i,n;super(...e),t="handleKeyDown",i=e=>{let{onClose:t,goToNext:i,goToPrevious:n}=this.props,o=e.keyCode||e.code;!e.ctrlKey&&!e.metaKey&&(["input","select","button","textarea"].includes(((document.activeElement||{}).tagName||"").toLowerCase())||document.activeElement&&document.activeElement.isContentEditable||(o===a.Z.LEFT?(e.preventDefault(),e.stopPropagation(),n&&n(),(0,l.nP)("web_keydown_left")):o===a.Z.RIGHT?(e.preventDefault(),e.stopPropagation(),i&&i(),(0,l.nP)("web_keydown_right")):o===a.Z.ESCAPE&&(e.preventDefault(),e.stopPropagation(),t())))},(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){return null}}let s=o},878709:function(e,t,i){i.d(t,{A:()=>p,G:()=>u});var n,a=i(667294);i(167912);var l=i(729434),o=i(415546),s=i(453179),r=i(607652),d=i(785893);let{Provider:c,get:u}=(0,l.Z)("VisualContext"),m=(void 0!==n||(n=i(441590)).hash&&"f5ddfd6a30ebe10b0f0a7b0bf12bea4e"!==n.hash&&console.error("The definition of 'VisualContext_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),g=({children:e,pinKey:t,overrideValue:i={}})=>{let n=(0,o.Z)(m,t),{videos:l,embed:u,link:g,isVideo:p}=n??{},h=(0,a.useMemo)(()=>l?.videoList?.v720P?.url?{duration:l.videoList.v720P.duration||void 0,height:l.videoList.v720P.height||void 0,thumbnail:l.videoList.v720P.thumbnail||void 0,url:l.videoList.v720P.url||void 0,width:l.videoList.v720P.width||void 0,captions_urls:l.videoList.v720P.captionsUrls||void 0}:void 0,[l?.videoList?.v720P?.duration,l?.videoList?.v720P?.height,l?.videoList?.v720P?.thumbnail,l?.videoList?.v720P?.url,l?.videoList?.v720P?.width,l?.videoList?.v720P?.captionsUrls]),_=(0,a.useMemo)(()=>l?.videoList?.vHLSV4?.url?{duration:l.videoList.vHLSV4.duration||void 0,height:l.videoList.vHLSV4.height||void 0,thumbnail:l.videoList.vHLSV4.thumbnail||void 0,url:l.videoList.vHLSV4.url||void 0,width:l.videoList.vHLSV4.width||void 0}:void 0,[l?.videoList?.vHLSV4?.duration,l?.videoList?.vHLSV4?.height,l?.videoList?.vHLSV4?.thumbnail,l?.videoList?.vHLSV4?.url,l?.videoList?.vHLSV4?.width]),y=(0,a.useMemo)(()=>l?.videoList?.vHLSV3MOBILE?.url?{duration:l.videoList.vHLSV3MOBILE.duration||void 0,height:l.videoList.vHLSV3MOBILE.height||void 0,thumbnail:l.videoList.vHLSV3MOBILE.thumbnail||void 0,url:l.videoList.vHLSV3MOBILE.url||void 0,width:l.videoList.vHLSV3MOBILE.width||void 0}:void 0,[l?.videoList?.vHLSV3MOBILE?.duration,l?.videoList?.vHLSV3MOBILE?.height,l?.videoList?.vHLSV3MOBILE?.thumbnail,l?.videoList?.vHLSV3MOBILE?.url,l?.videoList?.vHLSV3MOBILE?.width]),v=(0,a.useMemo)(()=>{let e=h||_||y;return l?.entityId&&e?{id:l.entityId,hasVideo:e,mp4:h||void 0,hls:_||void 0,hlsv3:y||void 0}:null},[_,y,h,l?.entityId]),x=(0,s.sY)(u?.type),f=(0,s.oU)({isVideo:p,link:g}),{mainPinImage:E,srcSet:T,srcSizes:b}=(0,r.Z)({pinKey:n}),L=n?.imageSpec_1200x||n?.imageSpec_orig||n?.imageSpec_736x||n?.imageSpec_564x||n?.imageSpec_474x||n?.imageSpec_236x,C=(0,a.useMemo)(()=>({height:L?.height??1,url:L?.url??"",width:L?.width??1}),[L]),I=n?.imageSpec_236x,S=(0,a.useMemo)(()=>I?.url?{height:I.height??1,url:I.url,width:I.width??1}:null,[I]),k=(0,a.useMemo)(()=>{let e=u?.subtype==="pinstory",t=i.mainImage||E;return{...i,pinAspectRatioType:(0,s.Ct)(E?.width??2,E?.height??3),mainImage:t,previewImage:void 0===i.previewImage?S:i.previewImage,mediaViewerImage:C,video:v,embed:u,isYoutubePin:f,isEmbeddedVideo:!!u?.src&&!x&&!e,isGif:x,imgSrc:x&&u?.src?u.src:t.url,...x?{}:{srcSet:T},srcSizes:b}},[E,S,C,v,u,f,x,T,b,i]);return(0,d.jsx)(c,{value:k,children:e})},p=({children:e,pinKey:t,overrideValue:i={}})=>(0,d.jsx)(g,{overrideValue:i,pinKey:t,children:e})},736802:function(e,t,i){i.d(t,{Z:()=>o});var n=i(20256),a=i(785893);let l=/^(?!.*#.*#)#[\p{L}\p{N}_]\S*$/gu;function o({closeupWithinMasonryEnabled:e=!1,peekCloseupEnabled:t=!1,mWebCloseupRedesignEnabled:i=!1,text:o}){let s=t||i?"200":"300";return o.split(new RegExp(/(#\S*)/)).map((t,i)=>{let o=`${i}-${t}`;return t.match(l)?(0,a.jsx)(n.xv,{color:"link",inline:!0,size:s,children:(0,a.jsx)(n.rU,{display:"inline",href:`/search/pins/?q=${encodeURIComponent(t.replace("#",""))}`,underline:"none",children:t})},o):(0,a.jsx)(n.xv,{color:e?"subtle":void 0,inline:!0,size:s,children:t},o)})}},478086:function(e,t,i){i.d(t,{Z:()=>y});var n,a=i(667294);i(244311);var l=i(20256),o=i(471998),s=i(736802),r=i(980787),d=i(415546),c=i(805205),u=i(601686),m=i(785893);let g=(void 0!==n||(n=i(658559)).hash&&"77396be9e54491e35d44dc059d7664fc"!==n.hash&&console.error("The definition of 'DescriptionWithLinksAndMentions_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),p=e=>null!=e&&e>-1,h=({color:e,mention:t,tagObjectId:i,tagType:n,textSize:a})=>{let{logContextEvent:o}=(0,r.u)();return(0,m.jsx)(l.rU,{display:"inlineBlock",href:`/${t.substr(1)}`,onClick:({event:e})=>{e.stopPropagation(),o({event_type:101,element:11915,aux_data:{tag_id:i,tag_type:n}})},underline:"none",children:(0,m.jsx)(l.xv,{color:e,inline:!0,overflow:"normal",size:a,weight:"bold",children:t},t)},i)},_=({color:e,link:t,tagObjectId:i,tagType:n,text:a,textSize:o})=>{let{logContextEvent:s}=(0,r.u)(),d=(0,c.Z)({site:"www"}),u=t.startsWith("pinterest://")?t.replace("pinterest://",`${d}/`):t;return(0,m.jsx)(l.xv,{color:e,inline:!0,overflow:"normal",size:o,children:(0,m.jsx)(l.rU,{display:"inlineBlock",href:u,onClick:({event:e})=>{e.stopPropagation(),s({event_type:101,element:18123,aux_data:{tag_id:i,tag_type:n,url:t}})},underline:"hover",children:a},i)},a)},y=({description:e,mentionLinkColor:t,pinKey:i,shouldAdjustOffset:n,shouldMakeHashtagLinksFromText:l,textSize:r,descriptionLinks:c,userMentionTags:y})=>{let{closeupWithinMasonryEnabled:v,peekCloseupEnabled:x}=(0,u.x4)(),f=(0,d.Z)(g,i),{hyperlinkKeywordsEnabled:E}=(0,o.Z)(),T=y?.length?y.map(e=>({...f?.userMentionTags?.find(t=>t.offset===e.originalOffset),...e})):f?.userMentionTags??[],b=c?.length?c.map(e=>({...f?.descriptionLinks?.find(t=>t.offset===e.originalOffset),...e})):f?.descriptionLinks??[],L=T.length>0,C=E&&b.length>0;if(!L&&!C)return(0,m.jsx)(a.Fragment,{children:e});let I=0,S=[];return[...T.map(t=>({...t,type:"mention",offset:n?((e,t)=>{let i=t.substr(0,e);return(e??0)-(i.length-i.replace(/\s+/g," ").length)})(t.offset??0,e):t.offset??0})),...E?b.map(e=>({...e,type:"link",offset:e.offset??0})):[]].filter(e=>p(e.offset)&&p(e.length)).sort((e,t)=>(e.offset??0)-(t.offset??0)).forEach(i=>{let n=i?.offset??0,a=i?.length??0,l=e.substr(I,n-I),o=e.substr(n,a);S.push(l),i?.type==="mention"?S.push((0,m.jsx)(h,{color:t,mention:o,tagObjectId:i.objectId,tagType:i.tagType,textSize:r})):i?.type==="link"&&i?.link&&S.push((0,m.jsx)(_,{color:t,link:i.link,tagObjectId:i.objectId,tagType:i.tagType,text:o,textSize:r})),I=n+a}),S.push(e.substr(I)),(l?S.flatMap(e=>"string"!=typeof e?e:(0,s.Z)({closeupWithinMasonryEnabled:v,peekCloseupEnabled:x,text:e})):S).reduce((e,t)=>(0,m.jsxs)(a.Fragment,{children:[e,t]}),null)}},406196:function(e,t,i){i.d(t,{E:()=>r,N:()=>d});var n=i(667294),a=i(655202),l=i(729434),o=i(785893);let{Provider:s,get:r}=(0,l.Z)("Flag"),d=({children:e})=>{let[t,i]=(0,n.useState)(),[l,r]=(0,n.useState)(a.Zw.REPORT),[d,c]=(0,n.useState)(a.qb.STARTED),[u,m]=(0,n.useState)(),[g,p]=(0,n.useState)(),h=(0,n.useMemo)(()=>({flagReason:g,flow:l,status:d,selectedReason:u,modalTitle:t,setFlagReason:p,setFlow:r,setModalTitle:i,setStatus:c,setSelectedReason:m}),[t,l,d,u,g]);return(0,o.jsx)(s,{value:h,children:e})}},655202:function(e,t,i){i.d(t,{Vm:()=>l,Zw:()=>n,qb:()=>a});let n={REPORT:"REPORT",BLOCK:"BLOCK",END:"END"},a={STARTED:"STARTED",SELECTED:"SELECTED",SUBMITTED:"SUBMITTED",PROCESSING:"PROCESSING",COMPLETED:"COMPLETED"},l={CONVERSATION:"CONVERSATION",DID_IT:"DID_IT"}},47944:function(e,t,i){i.d(t,{Z:()=>s});var n=i(20256),a=i(744862),l=i(525839),o=i(785893);let s=({isQuestion:e,name:t,size:i,src:s})=>{let r=(0,l.ZP)();return(0,o.jsxs)(n.xu,{"data-test-id":"comment-avatar-container",position:"relative",children:[(0,o.jsx)(a.qE,{name:t,size:i,src:s}),e&&(0,o.jsxs)(n.xu,{alignItems:"center",bottom:!0,display:"flex",height:16,justifyContent:"center",marginBottom:-1,marginEnd:-1,position:"absolute",right:!0,width:16,children:[(0,o.jsx)(n.xu,{position:"absolute",children:(0,o.jsx)(n.JO,{accessibilityLabel:r._('Q and A comment', 'comment.userAvatar.creator.q&aIndicator', 'question mark icon indicator background that comment is Q&A'),color:"dark",icon:"speech"})}),(0,o.jsx)(n.xu,{position:"absolute",children:(0,o.jsx)(n.JO,{accessibilityLabel:r._('Q and A comment', 'comment.userAvatar.creator.q&aIndicator', 'question mark icon indicator background that comment is Q&A'),color:"light",icon:"question-mark",size:8})})]})]})}},315787:function(e,t,i){i.d(t,{Z:()=>eo});var n=i(20256),a=i(667294),l=i(581722),o=i(473727),s=i(767439),r=i(111923),d=i(406196),c=i(47944),u=i(296691),m=i(333651),g=i(773655),p=i(744862),h=i(785893);let _={helpfulStyle:{backgroundImage:`url(${m})`},lovedStyle:{backgroundImage:`url(${g})`}},y=({response:e,handleReactionListHover:t,maybeDismissReactionListWithDelay:i})=>{let a=14===e.reaction_type,l=1===e.reaction_type,o=e.user.is_private_profile?e.user.first_name:e.user.full_name;return(0,h.jsxs)(n.kC,{alignItems:"center",children:[(0,h.jsx)(n.Tg,{href:`/${e.user.username}/`,onBlur:i,onFocus:t,children:(0,h.jsxs)(n.kC,{alignItems:"center",children:[(0,h.jsx)(n.xu,{maxWidth:40,children:(0,h.jsx)(p.qE,{accessibilityLabel:"",name:o,outline:!0,size:"sm",src:e.user.image_medium_url})}),(0,h.jsx)(n.xu,{marginStart:2,maxWidth:80,children:(0,h.jsx)(n.xv,{color:"inverse",size:"100",weight:"bold",children:o})})]})}),(0,h.jsxs)(n.xu,{alignContent:"end",display:"flex",padding:2,children:[l&&(0,h.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:_.lovedStyle},"data-test-id":"comment-reaction-tray-loved-emoji",height:16,width:16}),a&&(0,h.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:_.helpfulStyle},"data-test-id":"comment-reaction-tray-helpful-emoji",height:16,width:16})]})]})};var v=i(821342),x=i(886981),f=i(448505),E=i(7872);let T=["userreaction.id","userreaction.reaction_type","userreaction.user()","user.first_name","user.full_name","user.id","user.image_medium_url","user.is_private_profile","user.username"],b=({commentId:e,handleReactionListHover:t,isMarkedHelpfulByMe:i,isLovedByMe:l,isTry:o,maybeDismissReactionListWithDelay:s})=>{let r=(0,v.Z)(),d=(0,f.Z)(),c=(0,x.Z)({name:"ApiResource",options:{url:o?`/v3/did_it/${e}/reacted_by/`:`/v3/aggregated_comments/${e}/reacted_by/`,field_sets:T}}),u=(0,E.lJ)(r,d)||("id"in r&&r.id?r.id:""),m=c.data;(l||i)&&m&&(m=m.filter(e=>e.user.id!==u),m=[{id:e,reaction_type:l?1:14,user:{first_name:(0,E.Fk)(r,d),full_name:(0,E.Fk)(r,d),id:u,image_medium_url:(0,E.gJ)(r,d),is_private_profile:!!r.isAuth&&!!r.isPrivateProfile,username:(0,E.Ms)(r,d)}},...m]);let g=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let{current:e}=g,t=()=>{c.isFetching||(c.isAtEnd?e?.removeEventListener("scroll",t):c.fetchMore())};return e?.addEventListener("scroll",t),()=>{e?.removeEventListener("scroll",t)}},[c]),(0,h.jsx)(n.xu,{ref:g,color:"selected",maxHeight:140,overflow:"scroll",rounding:2,width:180,children:m?.map(e=>(0,h.jsx)(n.xu,{"data-test-id":"reaction-list-single-user",margin:3,children:(0,h.jsx)(y,{handleReactionListHover:t,maybeDismissReactionListWithDelay:s,response:e})},e.id))})};var L=i(525839),C=i(821806),I=i(601686);let S=(0,a.lazy)(()=>i.e("46308").then(i.bind(i,766289))),k="comment-reaction-container-entry-point",j=({commentId:e,dismissReactionList:t,helpfulCount:i,isDesktop:l,isMarkedHelpfulByMe:o,isLovedByMe:s,isReactionListOpen:r,isTry:d,lovedCount:c,onReactionCountHover:p,onToggleHelpful:_,onToggleLove:y})=>{let v=(0,L.ZP)(),{isCommentComposerFocused:x}=(0,I.x4)(),f=(0,a.useRef)(null),E=l?16:12,[T,j]=(0,a.useState)(!1),A=!1,w=(c||0)+(i||0);o&&s&&(w-=1);let P=e=>()=>{j(e)},D=()=>{A=!0,p()},M=()=>{A=!1,setTimeout(()=>{A||t()},1e3)},R=l?(0,h.jsx)(n.xu,{"data-test-id":k,children:T?(0,h.jsx)(n.iP,{onMouseLeave:P(!1),onTap:P(!1),children:(0,h.jsx)(C.Z,{children:(0,h.jsx)(S,{onTooltipHover:P(!1),setHelpful:_(!0),setLoved:y(!0)})})}):(0,h.jsx)(n.iP,{onMouseEnter:P(!0),onTap:P(!0),children:(0,h.jsx)(n.JO,{accessibilityLabel:v._('React', 'comment.actionbar.react', 'accessibility label entry point to react to a comment'),color:"subtle",icon:"heart-outline",size:E})})}):(0,h.jsx)(n.xu,{"data-test-id":k,margin:-1.5,children:(0,h.jsx)(n.hU,{accessibilityLabel:v._('React', 'comment.actionbar.react', 'accessibility label entry point to react to a comment'),icon:"heart-outline",onClick:y(!0),size:"xs"})});return(0,h.jsxs)(n.kC,{alignItems:"center",gap:{row:l?1:1.5,column:0},children:[o||s?(0,h.jsx)(n.iP,{onTap:()=>{_(!1)(),y(!1)()},children:(0,h.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{backgroundImage:`url(${s?g:m})`,backgroundSize:"contain"}},"data-test-id":s?"comment-reaction-container-loved-emoji":"comment-reaction-container-helpful-emoji",height:E,width:E})}):R,w>0&&(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)(n.iP,{onMouseEnter:D,onMouseLeave:M,onTap:D,children:(0,h.jsx)(n.xu,{ref:f,"data-test-id":"comment-reaction-container-reaction-count",display:l?void 0:"flex",children:(0,h.jsx)(n.xv,{color:l?"subtle":"default",inline:!0,size:l?"200":"100",weight:"bold",children:w})})}),r&&(0,h.jsx)(n.mh,{zIndex:u.Ty,children:(0,h.jsx)(n.J2,{anchor:f.current,idealDirection:"down",onDismiss:t,positionRelativeToAnchor:!1,shouldFocus:!x,children:(0,h.jsx)(n.iP,{onMouseEnter:D,onMouseLeave:M,children:(0,h.jsx)(b,{commentId:e,handleReactionListHover:D,isLovedByMe:s,isMarkedHelpfulByMe:o,isTry:d,maybeDismissReactionListWithDelay:M})})})})]})]})};var A=i(624895),w=i(54424),P=i(545961),D=i(162321);function M(e){let{comment:t,commentTags:i,handlePhotoTap:l,isDesktop:o,previewPhoto:s,taggedUsers:r}=e,[d,c]=(0,a.useState)(!1),{user:{username:u}}=t,m="text"in t?t.text:t.details,g=o?`${u} ${m}`:m,{height:p,url:_,width:y}=s||{},v=p??P.Vb,x=y??P.mu;return(0,h.jsxs)(n.xu,{children:[(0,h.jsx)(D.Z,{isFirstTaggedUserAuthor:!0,shouldShowFirstNameOnly:!0,taggedUsers:r,tags:i,text:g}),o||!o?(0,h.jsx)(n.xu,{marginBottom:o?void 0:1.5,marginTop:o?1:.5,children:(0,h.jsx)(P.ZP,{canEnlargePhoto:o,isSelectedPhoto:!1,previewPhoto:s})}):(0,h.jsx)(n.xu,{height:150,marginBottom:o?4:2,marginTop:1,width:150,children:(0,h.jsx)(n.iP,{disabled:!o,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),onTap:l,children:(0,h.jsx)(n.zd,{rounding:2,wash:!0,children:_&&(0,h.jsx)(n.Ee,{alt:_,color:"#efefef",naturalHeight:v,naturalWidth:x,src:_,children:(0,h.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{cursor:o?"zoom-in":void 0,backgroundColor:`rgba(17, 17, 17, ${.4*!!d})`}},height:"100%",width:"100%"})},_)})})})]})}var R=i(667835),O=i(302148),F=i(105433),G=i(696323);function Z(e){let{featuredCommentId:t,parentId:i,parentType:o,inCommentsImprovedDropdownExp:s,inCommentsPopover:r,isDesktop:d,isLoading:c,isReadOnly:u,openOverflowMenu:m,replyingToCommentId:g,toggleEditComposer:p,toggleHelpful:_,toggleLike:y,toggleReplyComposer:v,isORBACProfileManager:x,isVideo:f,storyPinDataId:E,pinId:T,closeupAttributionId:b,aggregatedPinDataId:C,closeupAttributionUsername:I,pinnerId:S,reactionListCommentId:k,showReactionListForComment:j,viewParameter:A}=e,w=(0,L.ZP)(),P=(0,R.vs)(),D=(0,F.lV)(),M=(0,l.v9)(({feeds:e})=>{let t=e[`${G.Z.AGGREGATED_COMMENT_REPLIES}:${i}`]||[],n=e[`${G.Z.AGGREGATED_COMMENTS}:${i}`]||[];return t.concat(n).reduceRight((e,{id:t})=>{let i=D[t];return i?[...e,i]:e},[])}),Z=(0,a.useRef)(!0),z=(0,a.useRef)(M.length),[N,H]=(0,a.useState)(1),[K,U]=(0,a.useState)(!1),B=N===M.length;return(0,a.useEffect)(()=>{let e=z.current,t=M.length;Z.current?t>0&&(Z.current=!1):t>e&&U(!0),t!==e&&H(e=>e>1?t:+(t>0)),z.current=t},[M.length]),(0,h.jsxs)(a.Fragment,{children:[M.length>1&&(0,h.jsx)(n.iP,{onTap:()=>{H(B?0:M.length)},children:(0,h.jsxs)(n.xu,{alignItems:d?void 0:"center",display:d?void 0:"flex",marginBottom:d?4:6,children:[d?(0,h.jsx)(n.xu,{display:"inlineBlock",marginEnd:2,children:(0,h.jsx)(n.xv,{color:"subtle",size:"200",weight:"bold",children:"⎯⎯"})}):(0,h.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{background:P?"white":"black"}},height:1,marginEnd:2,width:32}),(0,h.jsx)(n.xv,{color:d?"subtle":"default",inline:!0,size:"100",weight:"bold",children:B?w._('Hide replies', 'comment.button.hideReplies', 'hide comment replies'):(0,O.nk)(w.ngettext('View {{ commentCount }} reply', 'View {{ commentCount }} replies', M.length, 'comment.button.showReplies', 'show comment replies'),{commentCount:M.length})})]})}),(0,h.jsx)(eo,{aggregatedPinDataId:C,closeupAttributionId:b,closeupAttributionUsername:I,comments:(()=>{if(0===N||0===M.length)return[];if(1===N)if(K)return M.slice(-1);else return M.slice(0,1);return M.slice(0,N)})(),commentsDisabled:!1,featuredCommentId:t,gapSize:d?2:6,inCommentsImprovedDropdownExp:s,inCommentsPopover:r,isDesktop:d,isLoading:c,isORBACProfileManager:x,isReadOnly:u,isVideo:f,openOverflowMenu:m,parentId:i,parentType:o,pinId:T,pinnerId:S,reactionListCommentId:k,replyingToCommentId:g,showReactionListForComment:j,storyPinDataId:E,toggleEditComposer:p,toggleHelpful:_,toggleLike:y,toggleReplyComposer:v,userAvatarSize:"sm",viewParameter:A})]})}var z=i(980787),N=i(657043),H=i(475498),K=i(670622),U=i(2420),B=i(15667),V=i(536652),$=i(87853),W=i(542092),q=i(636921),J=i(502066),Q=i(449613),Y=i(611134),X=i(401450),ee=i(78762);let et=(0,a.lazy)(()=>i.e("16592").then(i.bind(i,357966))),ei=(0,ee.Z)(()=>i.e("73842").then(i.bind(i,434780)),void 0,e=>434780,"app-packages-comment-CommentOverflowPopover"),en=(0,a.lazy)(()=>i.e("84046").then(i.bind(i,257233)));function ea(e){let t,i,{aggregatedPinDataId:m,closeupAttributionId:g,closeupAttributionUsername:p,comment:_,featuredCommentId:y,inCommentsImprovedDropdownExp:x,inCommentsPopover:T,isDesktop:b,isReadOnly:S,isVideo:k,openOverflowMenu:P,toggleReplyComposer:G,parentId:ee,parentType:ea=W.o.pin,pinId:el,storyPinDataId:eo,replyingToCommentId:es,showReactionListForComment:er,showTopCommentHeading:ed,toggleEditComposer:ec,toggleHelpful:eu,toggleLike:em,userAvatarSize:eg,isORBACProfileManager:ep,pinnerId:eh,reactionListCommentId:e_,viewParameter:ey}=e,{user:{id:ev,first_name:ex,id:ef,image_medium_url:eE,username:eT},id:eb,is_translatable:eL,comment_count:eC,helpful_count:eI,tags:eS=[]}=_,[ek,ej]=(0,a.useState)(!1),eA=ek&&_.translatedText||_.text,ew=!eL||""===_.translatedText,eP=(0,q.Z)(),eD=!1,eM=0,eR=!1,eO=!!_.marked_helpful_by_me,eF=b?[_.user]:[],eG="",eZ=new Date;"aggregatedcomment"===_.type?(eD=_.highlighted_by_pin_owner,eM=_.reaction_counts[1],eR=_.reaction_by_me>0,i=_?.media?.sticker,eF.push(..._.tagged_users),eG=b?`${eT} ${eA??""}`:eA??"",eZ=new Date(_.created_at)):(eM=_.like_count,eR=_.liked_by_me,t=_.images[0]||{},eG=b?`${eT} ${_.details}`:_.details,eZ=new Date(_.done_at));let ez=t?.originals,eN=i||ez,eH=(0,L.ZP)(),eK=(0,v.Z)(),{setIsMediaViewerOpen:eU,clientTrackingParams:eB,setIsCommentPopoverInteractionActive:eV}=(0,I.x4)(),{logContextEvent:e$}=(0,z.u)(),{isBot:eW}=(0,B.B)(),{showToast:eq}=(0,$.dI)(),eJ=(0,l.I0)(),eQ=(0,R.vs)(),eY=(0,a.useRef)(null),{hasApplicableLawForCountry:eX}=(0,Q.ZP)(),e0=!S||eX,e1="aggregatedcomment"===_.type&&1===_.comment_tag,e6=e1&&b,e4=(0,f.Z)(),e2=(0,E.lJ)(eK,e4),{nativeEngagementsHiddenForUser:e3}=(0,J.G)(),{aggregatedCommentsHiddenForUser:e7,translateAggregatedComment:e5,updateAggregatedComment:e9}=(0,F.nf)(),e8=(0,r.Z)(),te="userdiditdata"===_.type,tt=(0,K.Z)(),ti=eL&&!1,tn=(0,u.zs)(eT,eS,eQ,!b),ta={SHOW_TRANSLATION:eH._('Show translation', 'comment.translateButton.showTranslation', 'text for translation button when translation is available'),TRANSLATING:eH._('Translating...', 'comment.translateButton.translating', 'text for translation button while translating'),SHOW_ORIGINAL:eH._('Show original', 'comment.translateButton.showOriginal', 'text for translation button after translating')},tl=(0,a.useRef)(ta.SHOW_TRANSLATION),[to,ts]=(0,s.Z)(),[tr,td]=(0,a.useState)(!1),[tc,tu]=(0,a.useState)(!1),[tm,tg]=(0,a.useState)(!1),[tp,th]=(0,a.useState)(!1),[t_,ty]=(0,a.useState)(!1),[tv,tx]=(0,a.useState)(!1),[tf,tE]=(0,a.useState)(!1),[tT,tb]=(0,a.useState)(u.A9.NONE),tL=e=>()=>{ec?ec(_):tu(e)};(0,a.useEffect)(()=>{ti&&e$({event_type:10416,view_type:3,view_parameter:ey,component:"pin"===ea?13696:13697})},[e$,ea,ti,ey]),(0,a.useEffect)(()=>{eC>0&&!eW&&eJ((0,V.U)("aggregatedcomment"===_.type?"AggregatedCommentReplyFeedResource":"DidItCommentsResource",{options:{isUnifiedComment:!0,objectId:eb,redux_normalize_feed:!0}}))},[_.type,eb]);let tC=ea.toLowerCase()===W.o.aggregatedComment.toLowerCase()||ea.toLowerCase()===W.n.didIt.toLowerCase(),tI=_.user.first_name||"",tS=async({contentMarkdown:e,force:t,tags:i})=>{let n,a;th(!0);let l=_.id;if(tC&&(n=ea.toLowerCase()===W.n.didIt,l=ee,a=_.id),l)try{await e8({force:t,fromUnifiedComment:!0,objectType:te||n?W.o.didIt:W.o.aggregatedComment,objectId:l,orbacSubjectId:e2,tags:i,text:e,replyToCommentId:a})}catch(t){let e=(0,N.Z)(t,"code");if([U.ky,U.LJ].includes(e??0)&&b)return tb(e===U.ky?u.A9.WARNING:u.A9.BLOCK),th(!1),!1}return G&&G(void 0),th(!1),!0},tk=async({contentMarkdown:e,force:t,tags:i})=>{tg(!0);try{te?await eJ((0,Y.IU)({id:_.id,details:e,pinId:el??"",image_signatures:"image_signatures"in _&&_.image_signatures?_.image_signatures:[]})):await e9({commentId:_.id,force:t,orbacSubjectId:e2,tags:i,text:e})}catch(e){if([U.ky,U.LJ].includes((0,N.Z)(e,"code")??0)&&b)return tb(e.code===U.ky?u.A9.WARNING:u.A9.BLOCK),tg(!1),!1}return tu(!1),tg(!1),!0},tj=()=>{b?(eV(!tr),td(!tr)):P&&P(_)},tA=e=>()=>{eV(e),td(e),tE(e),e||e$({component:14349,event_type:9408})},tw=()=>{tb(u.A9.NONE)},tP=e=>{e?ts():to(),eU(!e),ty(!e)};(0,a.useEffect)(()=>{ek&&ew&&(ej(!ek),eq(({hideToast:e})=>(0,h.jsx)(H.Z,{onHide:e,text:eH._('Error - couldn\'t translate', 'comment.couldNotTranslate.toast', 'error toast that shows after unsuccessful translation'),type:"error"})))},[ek,ew]),ek?tl.current=_.translatedText?ta.SHOW_ORIGINAL:ta.TRANSLATING:tl.current=ta.SHOW_TRANSLATION;let tD=b?128:110,tM="aggregatedcomment"===_.type&&_.media?.sticker?.image_url&&(0,h.jsx)(n.xu,{height:tD,marginBottom:+!!b,marginTop:1,width:tD,children:_.media?.sticker?.image_url&&(0,h.jsx)(n.Ee,{alt:_.media?.sticker?.display_name??"",fit:"contain",naturalHeight:0,naturalWidth:0,src:_.media.sticker.image_url})});return(0,h.jsxs)(a.Fragment,{children:[(0,h.jsx)(n.xH,{accessibilityLabel:"Loading comment",show:tm}),!tc&&!tm&&(0,h.jsxs)(n.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,h.jsx)(n.xu,{marginEnd:2,children:(0,h.jsx)(o.rU,{to:`/${eT}/`,children:(0,h.jsx)(c.Z,{isQuestion:e6,name:ex||eT||"",size:eg,src:eE??""})})}),(0,h.jsxs)(n.kC,{direction:"column",flex:"grow",justifyContent:"start",children:[(0,h.jsxs)(n.kC,{justifyContent:"between",children:[(0,h.jsx)(n.kC.Item,{minWidth:0,children:(0,h.jsxs)(n.kC,{dataTestId:"author-and-comment-container",direction:"column",children:[!b&&(0,h.jsxs)(n.kC,{alignItems:"center",gap:{row:1,column:0},children:[(0,h.jsx)(D.Z,{isFirstTaggedUserAuthor:!0,lineHeight:"14px",marginEnd:0,shouldShowFirstNameOnly:!0,size:"100",taggedUsers:[_.user],tags:(0,u.zs)(eT,[],eQ),text:eT}),e1&&!ed&&(0,h.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:"14px"}},children:(0,h.jsx)(n.xv,{color:"subtle",size:"100",children:eH._('asked a question \uD83D\uDC40', 'comment.question.label', 'label on a comment that is a question')})}),ed&&(0,h.jsxs)(n.kC,{children:[(0,h.jsx)(n.xu,{alignItems:"center",display:"flex",marginEnd:1,children:(0,h.jsx)(n.JO,{accessibilityLabel:(0,u.yW)(eH),color:"recommendation",icon:"star",size:12})}),(0,h.jsx)(n.xv,{color:"recommendation",size:"100",weight:"bold",children:(0,u._q)(eH)})]}),(e1||ed)&&eZ&&(0,h.jsx)(n.xv,{color:"subtle",size:"100",children:"·"}),eZ&&(0,h.jsx)(n.xu,{"data-test-id":"comments-time-passed",children:(0,h.jsx)(n.xv,{color:"subtle",size:"100",children:tt(eZ,!0)})})]}),te?(0,h.jsx)(M,{comment:_,commentTags:tn,handlePhotoTap:()=>tP(t_),isDesktop:b,previewPhoto:ez,taggedUsers:eF}):(0,h.jsx)(D.Z,{isFirstTaggedUserAuthor:!!b,lineHeight:b?void 0:"21px",marginBottom:b?void 0:"4px",shouldShowFirstNameOnly:!0,taggedUsers:eF,tags:tn,text:eG}),tM,ti&&(0,h.jsx)(n.xu,{marginBottom:2,marginTop:2,children:(0,h.jsx)(n.iP,{onTap:()=>void(!ek&&!_.translatedText&&e5(_.id),ek||tl.current!==ta.SHOW_TRANSLATION?ek&&tl.current===ta.SHOW_ORIGINAL&&e$({event_type:10418,view_type:3,view_parameter:ey,component:"pin"===ea?13696:13697}):e$({event_type:10417,view_type:3,view_parameter:ey,component:"pin"===ea?13696:13697}),ej(!ek)),children:(0,h.jsx)(n.xv,{color:"subtle",size:"300",weight:"bold",children:tl.current})})})]})}),y===eb&&(0,h.jsx)(n.xu,{alignSelf:"center",color:"primary",height:8,minWidth:8,rounding:"pill"})]}),eD&&(0,h.jsx)(n.xu,{marginBottom:b?3:1.5,marginTop:b?4:-.5,children:(0,h.jsx)(n.xv,{size:"100",children:(0,O.nk)(eH._('Highlighted by @{{ closeupAttributionUsername }}', 'comment.highlighted.label', 'label on comment that has been highlighted by the Pin creator'),{closeupAttributionUsername:p})})}),e0&&(0,h.jsx)(n.xu,{alignItems:"center",display:"flex",height:b?25:"100%",justifyContent:"between",position:"relative",children:(0,h.jsxs)(n.kC,{alignItems:"center",gap:{row:b?5:4,column:0},children:[!S&&b&&(0,h.jsx)(n.xu,{"data-test-id":"comments-time-passed",children:(0,h.jsx)(n.xv,{color:"subtle",size:"200",children:tt(eZ,!0)})}),!S&&(0,h.jsx)(n.xu,{"data-test-id":"comment-reply-button-container",children:(0,h.jsx)(n.iP,{onTap:()=>{G&&G(_,ee,ea)},children:(0,h.jsx)(n.xv,{color:b?"subtle":"default",size:b?"200":"100",weight:"bold",children:eH._('Reply', 'comment.button.reply', 'entry point to reply to comment')})})}),!S&&(0,h.jsx)(j,{commentId:eb,dismissReactionList:()=>{er(void 0)},helpfulCount:eI,isDesktop:b,isLovedByMe:eR,isMarkedHelpfulByMe:eO,isReactionListOpen:e_===eb,isTry:te,lovedCount:eM,onReactionCountHover:()=>{er(eb),e$({event_type:9906,component:"pin"===ea?13696:13697,view_type:3,view_parameter:ey})},onToggleHelpful:e=>()=>{eO!==e&&eu(eb,!e,te)()},onToggleLove:e=>()=>{eR!==e&&em(eb,!e,te)()}}),!("id"in eK&&eK.id===ef&&e1)&&(b?(0,h.jsx)(n.xu,{ref:eY,"data-test-id":"comment-more-options",children:(0,h.jsx)(n.hU,{accessibilityLabel:eH._('More', 'comment.button.more', 'see more options for comment'),icon:"ellipsis",iconColor:"gray",onClick:tj,size:"xs"})}):(0,h.jsx)(n.xu,{"data-test-id":"comment-more-options",children:(0,h.jsx)(n.iP,{onTap:tj,children:(0,h.jsx)(n.JO,{accessibilityLabel:eH._('More', 'comment.button.more', 'see more options for comment'),color:eQ?"light":"dark",icon:"ellipsis",size:12})})}))]})})]})]}),b&&(0,h.jsxs)(a.Fragment,{children:[tc&&!(T||x)&&(0,h.jsx)(n.xu,{marginTop:3,children:(0,h.jsx)(A.Z,{clientTrackingParams:eB,commentWarningModalState:tT,dismissCommentWarningModal:tw,initialTags:_.tags,initialText:"aggregatedcomment"===_.type?_.text:_.details,isEditing:!0,objectType:W.o.aggregatedComment,onAddItem:tk,onCancelItem:tL(!1),postedPhoto:eN,showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:ey})}),es===eb&&(0,h.jsx)(n.xu,{marginStart:12*!tC,marginTop:3,children:(0,h.jsx)(A.Z,{commentWarningModalState:tT,dismissCommentWarningModal:tw,initialTags:tC?[{offset:0,object_id:ev,length:tI.length,tag_type:1}]:[],initialText:tC?`${tI} `:"",isReplying:!0,objectType:W.o.aggregatedComment,onAddItem:tS,onCancelItem:()=>{G&&G()},showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:ey})})]}),(eC>0||tp)&&(0,h.jsx)(n.xu,{marginStart:b?12:10,marginTop:b?4:3,children:(0,h.jsx)(Z,{aggregatedPinDataId:m,closeupAttributionId:g,closeupAttributionUsername:p,featuredCommentId:y,inCommentsImprovedDropdownExp:x,inCommentsPopover:T,isDesktop:b,isLoading:tp,isORBACProfileManager:ep,isReadOnly:S,isVideo:k,openOverflowMenu:P,parentId:eb,parentType:_.type,pinId:el,pinnerId:eh,reactionListCommentId:e_,replyingToCommentId:es,showReactionListForComment:er,storyPinDataId:eo,toggleEditComposer:ec,toggleHelpful:eu,toggleLike:em,toggleReplyComposer:G,viewParameter:ey})}),b&&e0&&(0,h.jsx)(ei,{aggregatedPinDataId:m,anchor:eY.current,closeupAttributionId:g,comment:_,dismiss:e=>{td(!1),e||(eV(!1),e$({component:14349,event_type:10128}))},inCommentsPopover:!!T,isOpen:tr,isReply:tC,onEdit:tL(!0),onShowBlockUserModal:tA(!0),parentId:ee,pinId:el,pinnerId:eh}),tv&&(0,h.jsx)(C.Z,{children:(0,h.jsx)(d.N,{children:(0,h.jsx)(en,{aggregatedPinDataId:m,didItDataId:eb,onClose:e=>()=>{tx(!e)},pinId:el??"",username:eT,users:[_.user]})})}),tf&&(0,h.jsx)(C.Z,{children:(0,h.jsx)(et,{firstName:ex??"",onBlockUser:()=>{eJ((0,X.Ge)({id:ev,orbacSubjectId:e2,blockSource:"comment",blockContext:eb,logContextEvent:e$})),e7(ev),e3(ev),e$({event_type:101,component:13712,element:87,view_type:220,aux_data:{creator_id:eK.isAuth?eK.id:null}}),e$({component:14349,event_type:9407}),tE(!1),eP(),eV(!1)},onClearModal:tA(!1)})}),!!ez&&t_&&(0,h.jsx)(w.Z,{onDismiss:()=>tP(t_),photo:ez})]})}var el=i(351607);function eo(e){let t,i,{aggregatedPinDataId:a,comments:l,commentsDisabled:o,commentsScrollContainerRef:s,featuredCommentId:r,gapSize:d=6,inCommentsImprovedDropdownExp:c,inCommentsPopover:u,isDesktop:m,isLoading:g=!1,isReadOnly:p,openOverflowMenu:_,toggleReplyComposer:y,parentId:v,parentType:x,replyingToCommentId:f,showingCloseupCommentModule:E,toggleEditComposer:T,toggleHelpful:b,toggleLike:C,userAvatarSize:S,isORBACProfileManager:k,isVideo:j,storyPinDataId:A,pinId:w,closeupAttributionId:P,closeupAttributionUsername:D,pinnerId:M,showReactionListForComment:R,reactionListCommentId:O,viewParameter:F}=e,G=(0,L.ZP)(),{closeupWithinMasonryEnabled:Z}=(0,I.x4)(),z=!!E&&!1;return(u?t="12px":Z&&(t="8px"),i=A?"story":j?"video":"pin",o)?(0,h.jsx)(n.xu,{alignSelf:"center","data-test-id":"comments-disabled-label",marginTop:Z?2:void 0,width:"100%",children:(0,h.jsx)(n.xv,{align:m?"start":"center",color:"subtle",children:G._('Comments are turned off for this Pin', 'commentThread.disabledState.message', 'Comments are turned off or disabled for this pin')})}):l.length>0?(0,h.jsxs)(n.xu,{ref:s,dangerouslySetInlineStyle:{__style:{gap:`${4*d}px 0`,overscrollBehavior:u?"none":"auto",scrollbarGutter:Z?"stable":void 0,paddingTop:t}},"data-test-id":"aggregated-comment-list",direction:"column",display:"flex",maxHeight:Z&&!u?722:"100%",overflow:Z?"auto":void 0,width:"100%",children:[l.map((e,t)=>(0,h.jsx)(el.Fw,{componentType:"pin"===x?13696:13697,impressionAuxFields:{commentId:e.id,pinId:w,pinOwnerUserId:P,pinType:i,parentId:v,parentType:x,commentType:"aggregatedComment"},impressionType:"Comment",loggingId:e.id,slotIndex:t,viewType:m?3:98,children:({impressionTrackerRef:i})=>{let o=t===l.length-1;return(0,h.jsx)(n.xu,{ref:i,dangerouslySetInlineStyle:{__style:{paddingBottom:u&&o?"24px":"0px"}},"data-test-id":"commentThread-comment",tabIndex:0,children:(0,h.jsx)(ea,{aggregatedPinDataId:a,closeupAttributionId:P,closeupAttributionUsername:D,comment:e,featuredCommentId:r,inCommentsImprovedDropdownExp:c,inCommentsPopover:u,isDesktop:m,isORBACProfileManager:k,isReadOnly:p,isVideo:j,openOverflowMenu:_,parentId:v,parentType:x,pinId:w,pinnerId:M,reactionListCommentId:O,replyingToCommentId:f,showReactionListForComment:R,showTopCommentHeading:z&&0===t,storyPinDataId:A,toggleEditComposer:T,toggleHelpful:b,toggleLike:C,toggleReplyComposer:y,userAvatarSize:S,viewParameter:F})})}},e.id)),g&&(0,h.jsx)(n.xH,{accessibilityLabel:G._('Comments loading', ' - ', ' -- '),show:g})]}):(0,h.jsx)(n.xu,{alignSelf:"center",width:"100%",children:(0,h.jsx)(n.xH,{accessibilityLabel:G._('Comments loading', ' - ', ' -- '),show:g})})}},624895:function(e,t,i){i.d(t,{Z:()=>s});var n=i(667294),a=i(782259),l=i(785893);let o=(0,n.lazy)(()=>Promise.all([i.e("49124"),i.e("8907"),i.e("13389")]).then(i.bind(i,656379)));function s(e){return(0,l.jsx)(a.Z,{fallback:null,children:(0,l.jsx)(o,{...e})})}},54424:function(e,t,i){i.d(t,{Z:()=>r});var n=i(20256),a=i(762802),l=i(678213),o=i(525839),s=i(785893);function r({onDismiss:e,photo:t}){let i=(0,o.ZP)(),{height:r,url:d,width:c}=t,u=Math.min(r??936,936),m="100vh",g=i._('Close media viewer', 'comments.photo.mediaViewer.close', 'Close media viewer overlay');return(0,s.jsxs)(n.mh,{zIndex:l.b7,children:[(0,s.jsx)(n.iP,{mouseCursor:"zoomOut",onTap:e,children:(0,s.jsxs)(n.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}},"data-test-id":"comment-media-viewer",display:"flex",height:m,justifyContent:"center",left:!0,position:"fixed",right:!0,top:!0,width:"100%",children:[(0,s.jsx)(n.xu,{left:!0,padding:5,position:"absolute",top:!0,children:(0,s.jsx)(n.hU,{accessibilityLabel:g,icon:"cancel",iconColor:"white",onClick:e,padding:3,size:"lg"})}),(0,s.jsx)(n.xu,{dangerouslySetInlineStyle:{__style:{margin:"0 84px"}},height:m,maxHeight:u,width:c,children:d&&(0,s.jsx)(n.Ee,{alt:d??"",fit:"contain",naturalHeight:r??1,naturalWidth:c??1,src:d},d)})]})}),(0,s.jsx)(a.Z,{onClose:e})]})}},545961:function(e,t,i){i.d(t,{Vb:()=>p,ZP:()=>_,mu:()=>h});var n=i(667294),a=i(20256),l=i(767439),o=i(296691),s=i(436873),r=i(54424),d=i(525839),c=i(15667),u=i(647709),m=i(601686),g=i(785893);let p=150,h=346;function _({canEnlargePhoto:e,containerWidth:t,isSelectedPhoto:i,previewPhoto:_,removeSelectedPhoto:y}){let v=(0,d.ZP)(),x=(0,u.HG)(),{isRTL:f}=(0,c.B)(),{setIsMediaViewerOpen:E}=(0,m.x4)(),[T,b]=(0,l.Z)(),[L,C]=(0,n.useState)(!1),[I,S]=(0,n.useState)(!1),[k,j]=(0,n.useState)(null),[A,w]=(0,n.useState)(o.WU),P=(0,s.Z)(_)?_?.url:_?.image_url;(0,n.useEffect)(()=>{(async()=>{P&&!(0,s.Z)(_)&&j(await new Promise((e,t)=>{let i=new Image;i.onload=()=>{e({width:i.width,height:i.height})},i.onerror=t,i.src=P}))})()},[P,_]);let D=(0,s.Z)(_)?_?.width:k?.width,M=(0,s.Z)(_)?_?.height:k?.height,R=D??0,O=M??0,F=P??"",G=Math.min((t||(x?h:312))/R,(x?p:110)/O,1),Z=v._('Remove photo', 'photoCommentPreview.removePhoto', 'Icon to remove the selected photo from the comment composer'),z=v._('Photo', 'photoCommentPreview.previewPhoto', 'Photo previewed as part of a comment'),N=e=>{e?b():T(),E(!e),C(!e)};return(0,g.jsxs)(a.xu,{height:G*O,marginTop:3*!!i,position:"relative",width:G*R,children:[(0,g.jsx)(a.iP,{disabled:!e,onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),onTap:()=>N(L),children:(0,g.jsx)(a.zd,{rounding:2,children:F&&(0,g.jsx)(a.Ee,{alt:z,color:A,naturalHeight:O,naturalWidth:R,onLoad:()=>{w(o.o),i&&URL.revokeObjectURL(F)},src:F,children:e&&(0,g.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{cursor:"zoom-in",backgroundColor:`rgba(17, 17, 17, ${.4*!!I})`}},height:"100%",width:"100%"})},z)})}),i&&(0,g.jsx)(a.xu,{alignItems:"center",display:"flex",height:24,justifyContent:"center",left:f,marginEnd:-3,marginTop:-3,position:"absolute",right:!f,top:!0,width:24,children:(0,g.jsx)(a.hU,{accessibilityLabel:Z,bgColor:"lightGray",icon:"cancel",onClick:y,size:"xs"})}),L&&(0,g.jsx)(r.Z,{onDismiss:()=>N(L),photo:_})]})}},436873:function(e,t,i){i.d(t,{Z:()=>n});let n=e=>e?.url!==void 0},607652:function(e,t,i){i.d(t,{Z:()=>d});var n,a=i(667294);i(167912);var l=i(415546),o=i(906498);let s=(void 0!==n||(n=i(673588)).hash&&"64a50a10a8f854ca82309453d98f41a7"!==n.hash&&console.error("The definition of 'useGetMainPinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function r(e,t){return e&&t?`${e} ${t}w`:null}function d({pinKey:e}){let t=(0,l.Z)(s,e),{anyEnabled:i,group:n}=(0,o.Z)(),d=(0,a.useMemo)(()=>t?.imageSpec_736x||t?.imageSpec_564x||t?.imageSpec_orig||t?.imageSpec_474x||t?.imageSpec_236x,[t]),c=(0,a.useMemo)(()=>{if(!t)return;let e=[r(t.imageSpec_736x?.url,t.imageSpec_736x?.width),r(t.imageSpec_1200x?.url,t.imageSpec_1200x?.width),{enabled:null,enabled_564x:r(t.imageSpec_564x?.url,t.imageSpec_564x?.width),enabled_orig:r(t.imageSpec_orig?.url,t.imageSpec_orig?.width)}[n]].filter(Boolean);return e.length>1?e.join(", "):void 0},[t,n]),u=i?"100cqw":void 0;return(0,a.useMemo)(()=>({mainPinImage:{url:d?.url||"",height:d?.height||1,width:d?.width||1},srcSet:c,srcSizes:u}),[d,c,u])}},906498:function(e,t,i){i.d(t,{Z:()=>o});var n=i(274320),a=i(15667),l=i(647709);let o=({skipExpActivation:e=!1}={})=>{let{checkExperiment:t}=(0,n.r)(),i=(0,l.HG)(),{isAuthenticated:o}=(0,a.B)();return o&&i?t("closeup_dweb_adaptive_images",{dangerouslySkipActivation:e}):{anyEnabled:!1,group:""}}},914071:function(e,t,i){i.d(t,{Z:()=>a});var n=i(667294);function a(e,t){let i=(0,n.useRef)([]),[a,l]=(0,n.useState)(),[o,s]=(0,n.useReducer)(a??(()=>t),t),r=(0,n.useCallback)(t=>{a?s(t):(i.current.length||e().then(e=>{l(()=>e.default)}),i.current=[...i.current,t])},[e,a]);return(0,n.useEffect)(()=>{a&&(i.current.forEach(s),i.current=[])},[a]),[o,r]}},105433:function(e,t,i){i.d(t,{pb:()=>x,nf:()=>f,lV:()=>E});var n=i(667294),a=i(581722),l=i(441143),o=i.n(l),s=i(575108),r=i(729434),d=i(686319),c=i(791948),u=i(503246),m=i(991384);let g={feature_map:Object.freeze({})},p=(e,t)=>{let i={...(0,m.Z)(e,t),...t.reaction_counts?{reaction_counts:t.reaction_counts}:Object.freeze({}),...t.tags?{tags:t.tags}:Object.freeze({}),...t.tagged_users?{tagged_users:t.tagged_users}:Object.freeze({})};return(0,u.ZP)(e,i)?e:i},h=(e,t)=>{if(e=e||g,"FETCH_COMPLETE"===t.type){let{payload:{resource:i}}=t,{data:n}=t.payload.response.resource_response;if("AggregatedCommentFeedResource"===i||"AggregatedCommentReplyFeedResource"===i||"DidItCommentsResource"===i){let t=(n||[]).reduce((t,i)=>(t[i.id]=p(e[i.id],i),t),{});return{...e,...t}}if("UnifiedCommentsResource"===i&&n&&n.length>0){let t=n.filter(e=>"aggregatedcomment"===e.type).reduce((t,i)=>(t[i.id]=p(e[i.id],i),t),{});return{...e,...t}}if("UnifiedCommentsPreviewResource"===i&&n&&n.length>0){let t=n.map(e=>e.aggregated_comment).reduce((t,i)=>(i&&(t[i.id]=p(e[i.id],i)),t),{}),i=n.map(e=>e.creator_reply).reduce((t,i)=>(i&&i.id&&(t[i.id]=p(e[i.id],i)),t),{});return{...e,...t,...i}}if("AggregatedCommentFeaturesResource"===i&&n&&Object.keys(n).length>0)return{...e,feature_map:n}}else if("AGGREGATED_COMMENT_CREATED"===t.type){let{payload:{aggregatedComment:i}}=t;return i.id?{...e,[i.id]:i}:e}else if("AGGREGATED_COMMENT_DELETED"===t.type||"AGGREGATED_COMMENT_HIDDEN"===t.type){let{payload:{aggregatedCommentId:i}}=t,n={...e};return delete n[i],n}else if("AGGREGATED_COMMENT_HIDDEN_FOR_USER"===t.type){let{payload:{userId:i}}=t;return Object.fromEntries(Object.entries(e).filter(e=>e[1].user?.id!==i))}else if("AGGREGATED_COMMENT_UPDATED"===t.type){let{payload:{data:i}}=t;return{...e,[i.id]:p(e?.[i.id],i)}}else if("AGGREGATED_COMMENT_LIKE_TOGGLED"===t.type){let{payload:{data:i}}=t,n=e?.[i.id],a=n?.reaction_counts[1]||0,l={1:i.reaction_by_me?a+1:a-1},o={...n,reaction_by_me:i.reaction_by_me,reaction_counts:l};return{...e,[i.id]:o}}else if("AGGREGATED_COMMENT_HELPFUL_TOGGLED"===t.type){let{payload:{data:i}}=t,n=e?.[i.id],a=n?.helpful_count||0,l=i.marked_helpful_by_me?a+1:a-1,o={...n,marked_helpful_by_me:i.marked_helpful_by_me,helpful_count:l};return{...e,[i.id]:o}}else if("AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED"===t.type){let{payload:{data:i}}=t,n={...e?.[i.aggregated_comment_id],highlighted_by_pin_owner:i.is_highlighted};return{...e,[i.aggregated_comment_id]:n}}else if("AGGREGATED_COMMENT_FEATURES_UPDATED"===t.type){let{payload:{data:{featureMap:i}}}=t;return{...e,feature_map:{...e?.feature_map,...i}}}else if("UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT"===t.type){let{payload:{increment:i,id:n}}=t,a=e?.[n];if(!a)return e;let l={...a,comment_count:a.comment_count+i};return{...e,[n]:l}}else if("DELETE_COMMENT_MENTION"===t.type){let{payload:{aggregatedCommentId:i,tagged_users:n}}=t,a={...e?.[i],tagged_users:n};return{...e,[i]:a}}else if("GET_COMMENT_TRANSLATION"===t.type){let{payload:{aggregatedCommentId:i,translatedText:n}}=t,a={...e?.[i],translatedText:n};return{...e,[i]:a}}return e};var _=i(785893);let{Provider:y,get:v}=(0,r.Z)("AggregatedComments");function x({children:e}){let t=(0,a.v9)(({resources:e})=>e?.UnifiedCommentsResource),i=g;t&&Object.values(t).forEach(e=>{let t=e.data?.filter(e=>"aggregatedcomment"===e.type),n=t?.reduce((e,t)=>(e[t.id]=p(i[t.id],t),e),{});i={...i,...n}});let[l,o]=(0,n.useReducer)(h,i),s=e=>{o({type:"FETCH_COMPLETE",payload:e})};(0,c.Z8)("AggregatedCommentFeaturesResource",s),(0,c.my)("AggregatedCommentFeaturesResource",s),(0,c.Z8)("AggregatedCommentFeedResource",s),(0,c.my)("AggregatedCommentFeedResource",s),(0,c.Z8)("AggregatedCommentReplyFeedResource",s),(0,c.my)("AggregatedCommentReplyFeedResource",s),(0,c.Z8)("DidItCommentsResource",s),(0,c.my)("DidItCommentsResource",s),(0,c.Z8)("UnifiedCommentsPreviewResource",s),(0,c.my)("UnifiedCommentsPreviewResource",s),(0,c.Z8)("UnifiedCommentsResource",s),(0,c.my)("UnifiedCommentsResource",s);let r=(0,n.useMemo)(()=>({aggregatedComments:l,dispatch:o}),[l,o]);return(0,_.jsx)(y,{value:r,children:e})}function f(){let{dispatch:e}=v();return(0,n.useMemo)(()=>({aggregatedCommentCreated(t,i){e({type:"AGGREGATED_COMMENT_CREATED",payload:{parentId:t,aggregatedComment:i}})},aggregatedCommentDeleted:(t,i)=>{e({type:"AGGREGATED_COMMENT_DELETED",payload:{parentId:t,aggregatedCommentId:i}})},aggregatedCommentHidden:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN",payload:{aggregatedCommentId:t}})},aggregatedCommentsHiddenForUser:t=>{e({type:"AGGREGATED_COMMENT_HIDDEN_FOR_USER",payload:{userId:t}})},flagAggregatedComment:async({isAggregatedComment:e=!0,commentId:t,reason:i,detailedReasons:n})=>{let a=e?`/v3/aggregated_comments/${t}/flag/`:`/v3/did_it/${t}/flag/`;return(0,d.Z)({url:a,method:"PUT",data:{commentId:t,reason:i,detailedReasons:n}})},deleteCommentMention:async t=>{let{resource_response:i}=await (0,d.Z)({url:`/v3/aggregated_comments/${t}/mentions/`,method:"DELETE",data:{fields:["aggregatedcomment.id","aggregatedcomment.tagged_users"]}}),n=i.data??{};e({type:"DELETE_COMMENT_MENTION",payload:{aggregatedCommentId:n.id,tagged_users:n.tagged_users}})},translateAggregatedComment:async t=>{try{let{resource_response:i}=await (0,d.Z)({url:`/v3/aggregated_comments/${t}/translate/`,method:"GET"}),n=i.data??"";e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:n}})}catch(i){e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:t,translatedText:""}})}},toggleAggregatedCommentHelpful:({aggregatedCommentId:t,isMarkedHelpfulByMe:i,orbacSubjectId:n})=>{(0,d.Z)({url:`/v3/helpful/1/${t}/`,method:i?"DELETE":"POST",data:n?{orbac_subject_id:n}:{}}),e({type:"AGGREGATED_COMMENT_HELPFUL_TOGGLED",payload:{data:{id:t,marked_helpful_by_me:!i}}})},toggleAggregatedCommentHighlight:async({aggregatedCommentId:t,pinId:i,isHighlighted:n})=>{o()(t,"Could not find comment"),o()(i,"Could not find Pin"),await (0,d.Z)({url:"/v3/aggregated_comments/pin/highlight/",method:"PUT",data:{aggregated_comment:t,pin:i,highlight:!n}}),e({type:"AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED",payload:{data:{aggregated_comment_id:t,pin_id:i,is_highlighted:!n}}})},toggleAggregatedCommentLike:({aggregatedCommentId:t,isLikedByMe:i,orbacSubjectId:n})=>{(0,d.Z)({url:`/v3/aggregated_comments/${t}/react/`,method:i?"DELETE":"POST",data:{reaction_type:1,...n?{orbac_subject_id:n}:{}}}),e({type:"AGGREGATED_COMMENT_LIKE_TOGGLED",payload:{data:{id:t,reaction_by_me:+!i}}})},updateAggregatedComment:async({commentId:t,force:i,orbacSubjectId:n,tags:a,text:l})=>{let{resource_response:o}=await s.Z.create("AggregatedCommentResource",{commentId:t,force:i,tags:a,text:l,...n?{orbacSubjectId:n}:{}}).callUpdate({showError:!1}),{tagged_users:r}=o.data??{};e({type:"AGGREGATED_COMMENT_UPDATED",payload:{data:{id:t,tagged_users:r.map(e=>({...e})),tags:JSON.parse(a),text:l}}})},updateAggregatedCommentFeatures:async({userId:t,featureMap:i,passcode:n,userConfirmPasscode:a})=>{let l={userId:t,featureMap:i,passcode:n,user_confirm_skip_passcode:a};void 0===a&&(l.user_confirm_skip_passcode=!1);let{resource_response:o}=await s.Z.create("AggregatedCommentFeaturesResource",l).callUpdate({showError:!1});e({type:"AGGREGATED_COMMENT_FEATURES_UPDATED",payload:{data:{featureMap:o.data??Object.freeze({})}}})},updateCommentCount:(t,i)=>{e({type:"UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT",payload:{increment:i,id:t}})}}),[e])}function E(){let{aggregatedComments:e}=v();return e}},502066:function(e,t,i){i.d(t,{G:()=>m,Kl:()=>g,vo:()=>u});var n=i(667294),a=i(729434),l=i(791948),o=i(914071),s=i(785893);let r=()=>i.e("83726").then(i.bind(i,3571)),{Provider:d,get:c}=(0,a.Z)("NativeEngagements");function u({children:e}){let[t,i]=(0,o.Z)(r,[]);(0,l.Z8)("NativeInteractionsResource",e=>{i({type:"FETCH_COMPLETE",payload:e})}),(0,l.my)("NativeInteractionsResource",e=>{i({type:"FETCH_MORE_COMPLETE",payload:e})});let a=(0,n.useMemo)(()=>({dispatch:i,nativeEngagements:t}),[i,t]);return(0,s.jsx)(d,{value:a,children:e})}function m(){let{dispatch:e}=c();return(0,n.useMemo)(()=>({nativeEngagementsHiddenForUser:t=>{e({type:"NATIVE_ENGAGEMENT_HIDDEN_FOR_USER",payload:{userId:t}})}}),[e])}function g(){let{nativeEngagements:e}=c();return e}},790427:function(e,t,i){i.d(t,{$8:()=>c,Dk:()=>d,Fk:()=>a,fS:()=>r,lI:()=>l,mS:()=>s,qW:()=>o});var n=i(20256);let a=new n.Ry(1),l=new n.Ry(3),o=2,s=new n.Ry(o),r=3,d=new n.Ry(100),c=new n.H3([d])},934603:function(e,t,i){i.d(t,{B:()=>b,Z:()=>I});var n,a=i(667294),l=i(581722);i(167912);var o=i(616550),s=i(20256),r=i(315787),d=i(821342),c=i(415546),u=i(886981),m=i(647709),g=i(341742),p=i(448505),h=i(7872),_=i(105433),y=i(542092),v=i(716751),x=i(611134),f=i(32082),E=i(793698),T=i(785893);let b=({aggregatedPinDataId:e,featuredCommentIds:t,featuredDidItIds:i,isDesktop:n,isReversed:a=!1,noCache:l=!1,orbacSubjectId:o=""})=>({name:"UnifiedCommentsResource",options:{aggregated_pin_id:e,comment_featured_ids:t,did_it_featured_ids:i,page_size:n?10:25,redux_normalize_feed:!0,is_reversed:a,...o?{orbac_subject_id:o}:{}},noCache:l}),L=(void 0!==n||(n=i(316387)).hash&&"6e4bec581cece19361386d6124ddde90"!==n.hash&&console.error("The definition of 'CommentThreadContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),C=({aggregatedPinDataId:e,closeupAttributionId:t,closeupAttributionUsername:i,commentsDisabled:n,hasComments:c,isReadOnly:L,pinId:C,isVideo:I,pinnerId:S,scrollContainer:k,setIsComposingNewComment:j=()=>{},showingCloseupCommentModule:A,storyPinDataId:w,viewParameter:P,toggleComposerForReply:D,openMwebOverflowMenu:M})=>{let{comment_id:R}=(0,o.UO)(),O=(0,l.I0)(),F=(0,m.HG)(),G=(0,d.Z)(),Z=(0,a.useRef)(c),z=(0,p.Z)(),N=(0,h.lJ)(G,z),H=(0,u.Z)(Z.current&&e?b({aggregatedPinDataId:e,featuredCommentIds:R?[R]:[],isDesktop:F}):null),{removeUnauthCommentPinId:K,unauthCommentPinId:U}=(0,v.o)(),B=(0,_.lV)(),{toggleAggregatedCommentHelpful:V,toggleAggregatedCommentLike:$}=(0,_.nf)(),W=(0,E.dM)(),q=(0,l.v9)(t=>(0,f.Z)(t,{aggregatedPinDataId:e,aggregatedComments:B,users:W})),[J,Q]=(0,a.useState)(void 0);(0,g.Z)(()=>{!F&&G.isAuth&&U&&C&&U===C&&(j(!0),K())}),(0,a.useEffect)(()=>{let e=()=>{let t=!!k&&k.scrollTop+k.clientHeight+10>=k.scrollHeight;H&&!H.isFetching&&(H.isAtEnd?k?.removeEventListener("scroll",e):t&&H.fetchMore())};return k?.addEventListener("scroll",e),()=>{k?.removeEventListener("scroll",e)}},[H,k]);let Y=2*(!F&&!n);return(0,T.jsx)(a.Fragment,{children:(0,T.jsx)(s.xu,{display:"flex",height:F||n||0!==q.length?void 0:"100%",marginTop:F?6:Y,width:"100%",children:(0,T.jsx)(r.Z,{aggregatedPinDataId:e,closeupAttributionId:t,closeupAttributionUsername:i,comments:q,commentsDisabled:n,isDesktop:F,isReadOnly:L,isVideo:I,openOverflowMenu:M,parentId:e??"",parentType:y.o.pin,pinId:C,pinnerId:S,reactionListCommentId:J,showingCloseupCommentModule:A,showReactionListForComment:Q,storyPinDataId:w,toggleHelpful:(e,t,i)=>()=>{i?O((0,x.YH)({didItDataId:e,isMarkedHelpfulByMe:t,orbacSubjectId:N})):V({aggregatedCommentId:e,isMarkedHelpfulByMe:t,orbacSubjectId:N})},toggleLike:(e,t,i)=>()=>{i?O((0,x.wH)({didItDataId:e,isLikedByMe:t,orbacSubjectId:N})):$({aggregatedCommentId:e,isLikedByMe:t,orbacSubjectId:N})},toggleReplyComposer:D,userAvatarSize:"sm",viewParameter:P})})})};function I({pinKey:e,...t}){let i=(0,c.Z)(L,e),n=(i?.aggregatedPinData?.commentCount||0)+(i?.aggregatedPinData?.didItData?.imagesCount||0);return(0,T.jsx)(C,{aggregatedPinDataId:i?.aggregatedPinData?.entityId,closeupAttributionId:i?.closeupAttribution?.entityId,closeupAttributionUsername:i?.closeupAttribution?.username,commentsDisabled:i?.commentsDisabled,disablePhotoCommentSelection:!!i?.doneByMe,hasComments:n>0&&!i?.commentsDisabled,isVideo:!!i?.videos?.videoList,pinId:i?.entityId,pinnerId:i?.pinner?.entityId,storyPinDataId:i?.storyPinData?.entityId,...t})}},716751:function(e,t,i){i.d(t,{o:()=>s,p:()=>r});var n=i(667294),a=i(729434),l=i(785893);let{Provider:o,get:s}=(0,a.Z)("Session");function r({children:e}){let[t,i]=(0,n.useState)(void 0),a=(0,n.useCallback)(()=>i(void 0),[]),s=(0,n.useMemo)(()=>({unauthCommentPinId:t,setUnauthCommentPinId:i,removeUnauthCommentPinId:a}),[t,a]);return(0,l.jsx)(o,{value:s,children:e})}},32082:function(e,t,i){i.d(t,{Z:()=>o});var n=i(442279),a=i(696323);let l={},o=(0,n.createSelector)((e,{aggregatedComments:t})=>t,({feeds:e},{aggregatedPinDataId:t})=>e[`${a.Z.UNIFIED_COMMENTS}:${t||""}`],({didItData:e})=>e,(e,{users:t})=>t??l,(e,t,i,n)=>{let a=new Set;return t?.map(({id:t,type:o})=>{if(a.has(t))return;a.add(t);let s="aggregatedcomment"===o.toLowerCase()?e[t]:i[t];if(!s)return;let r="user"in s&&("string"==typeof s.user?n[s.user]??l:s.user??l);return{...s,user:r??l}}).filter(e=>void 0!==e)||[]})},333651:function(e){e.exports="https://s.pinimg.com/webapp/commentHelpful-99007872.svg"},773655:function(e){e.exports="https://s.pinimg.com/webapp/commentLoved-7942dc4f.svg"}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/78946-c9a0c12bacec4230.mjs.map